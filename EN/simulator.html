<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compliance Simulator - AgileVizion</title>
    <link rel="alternate" hreflang="fr" href="../FR/simulator.html" />
    <link rel="alternate" hreflang="en" href="simulator.html" />
    <link rel="alternate" hreflang="x-default" href="../FR/simulator.html" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">
    <!-- Calendly Widget -->
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- EmailJS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: #f7fafc; }
        
        /* ===== NAVBAR ===== */
        .navbar { background: #1a202c; padding: 15px 40px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .navbar-brand { color: white; font-size: 1.5em; font-weight: bold; text-decoration: none; }
        .navbar-brand span { color: #2980b9; }
        .navbar-menu { display: flex; gap: 10px; align-items: center; }
        .navbar-menu a { color: white; text-decoration: none; padding: 10px 20px; border-radius: 5px; transition: background 0.3s; font-weight: 500; }
        .navbar-menu a:hover, .navbar-menu a.active { background: #2c3e50; }
        .lang-switch { display: flex; gap: 5px; margin-left: 20px; padding-left: 20px; border-left: 1px solid rgba(255,255,255,0.3); }
        .lang-switch a { padding: 5px 10px !important; font-size: 0.85em; opacity: 0.7; }
        .lang-switch a.active-lang { opacity: 1; background: rgba(255,255,255,0.1); }
        
        /* ===== HERO ===== */
        .hero { background: linear-gradient(135deg, #2980b9 0%, #1a5276 100%); color: white; padding: 50px 20px; text-align: center; }
        .hero h1 { font-size: 2em; margin-bottom: 12px; font-weight: 700; max-width: 800px; margin-left: auto; margin-right: auto; }
        .hero p { font-size: 1.1em; opacity: 0.95; max-width: 600px; margin: 0 auto; }
        
        /* ===== CONTAINER ===== */
        .container { max-width: 850px; margin: 0 auto; padding: 30px 20px; }
        
        /* ===== SECTION CARDS ===== */
        .section-card { background: white; border-radius: 10px; padding: 25px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
        .section-title { font-size: 1.15em; color: #1a202c; margin-bottom: 18px; padding-bottom: 10px; border-bottom: 3px solid #2980b9; display: flex; align-items: center; gap: 10px; }
        .section-title i { color: #2980b9; }
        
        /* ===== QUESTIONS ===== */
        .question-row { display: flex; align-items: center; gap: 12px; margin-bottom: 14px; flex-wrap: wrap; }
        .question-label { font-weight: 600; color: #2d3748; font-size: 0.9em; min-width: 220px; flex-shrink: 0; }
        .question-label .required { color: #c53030; margin-left: 2px; }
        .question-hint { font-size: 0.8em; color: #718096; font-style: italic; flex: 1; min-width: 120px; }
        .question-select { width: 180px; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 0.9em; background: white; cursor: pointer; transition: border-color 0.2s; flex-shrink: 0; }
        .question-select:focus { outline: none; border-color: #2980b9; }
        .question-select:hover { border-color: #2980b9; }
        .question-select.error { border-color: #c53030; background: #fef2f2; }
        .question-select.valid { border-color: #27ae60; }
        
        /* ===== VALIDATION MESSAGE ===== */
        .validation-msg { display: none; background: #fef2f2; border: 1px solid #c53030; color: #c53030; padding: 12px 15px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9em; }
        .validation-msg.visible { display: flex; align-items: center; gap: 10px; }
        .validation-msg i { font-size: 1.2em; }
        
        /* ===== PROGRESS BAR ===== */
        .progress-container { margin-bottom: 20px; }
        .progress-text { font-size: 0.85em; color: #718096; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .progress-bar { height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #2980b9, #27ae60); border-radius: 4px; transition: width 0.3s; }
        
        /* ===== BUTTON ===== */
        .btn-calculate { width: 100%; padding: 16px 30px; background: linear-gradient(135deg, #2980b9 0%, #1a5276 100%); color: white; border: none; border-radius: 8px; font-size: 1.15em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-calculate:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(41, 128, 185, 0.4); }
        .btn-calculate:disabled { background: #9ca3af; cursor: not-allowed; transform: none; box-shadow: none; }
        
        /* ===== RESULTS ===== */
        .results-section { display: none; }
        .results-section.visible { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        .results-summary { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px; }
        .summary-card { text-align: center; padding: 20px 15px; border-radius: 10px; color: white; }
        .summary-card.mandatory { background: linear-gradient(135deg, #c53030, #9b2c2c); }
        .summary-card.recommended { background: linear-gradient(135deg, #2980b9, #1a5276); }
        .summary-number { font-size: 2.5em; font-weight: 700; }
        .summary-label { font-size: 0.9em; opacity: 0.95; }
        
        /* ===== RESULTS CARDS ===== */
        .results-category { margin-bottom: 25px; }
        .results-category h3 { font-size: 1.1em; color: #1a202c; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .results-category h3 i { font-size: 0.9em; }
        .results-category h3.mandatory-title { color: #c53030; }
        .results-category h3.recommended-title { color: #2980b9; }
        
        .norm-card { background: #f8fafc; border-radius: 8px; padding: 15px 18px; margin-bottom: 10px; border-left: 4px solid; }
        .norm-card.mandatory { border-left-color: #c53030; }
        .norm-card.recommended { border-left-color: #2980b9; }
        .norm-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .norm-name { font-weight: 700; font-size: 1.05em; color: #1a202c; }
        .norm-badge { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 0.75em; font-weight: 600; }
        .norm-badge.mandatory { background: #fde8e8; color: #c53030; }
        .norm-badge.recommended { background: #ebf5fb; color: #2980b9; }
        .norm-why { font-size: 0.9em; color: #4a5568; margin-bottom: 6px; }
        .norm-sanction { font-size: 0.85em; color: #c53030; font-weight: 500; }
        .norm-sanction i { margin-right: 5px; }
        
        .no-results { text-align: center; padding: 30px; color: #718096; }
        .no-results i { font-size: 2em; margin-bottom: 10px; display: block; color: #27ae60; }
        
        /* ===== PDF SECTION ===== */
        .pdf-section { background: #ebf5fb; border: 2px solid #2980b9; border-radius: 10px; padding: 25px; margin-top: 25px; }
        .pdf-section h4 { color: #1a202c; margin-bottom: 8px; display: flex; align-items: center; gap: 10px; font-size: 1.1em; }
        .pdf-section h4 i { color: #2980b9; }
        .pdf-section p { font-size: 0.9em; color: #4a5568; margin-bottom: 15px; }
        .form-row { display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap; }
        .form-input { flex: 1; min-width: 180px; padding: 11px 14px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 0.95em; }
        .form-input:focus { outline: none; border-color: #2980b9; }
        .btn-send { padding: 11px 22px; background: #2980b9; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 0.95em; white-space: nowrap; transition: background 0.2s; }
        .btn-send:hover { background: #1a5276; }
        .btn-send:disabled { background: #9ca3af; cursor: not-allowed; }
        .success-msg { display: none; color: #166534; margin-top: 12px; font-size: 0.9em; padding: 12px; background: #dcfce7; border-radius: 6px; }
        .success-msg.visible { display: block; }
        .error-msg { display: none; color: #c53030; margin-top: 12px; font-size: 0.9em; padding: 12px; background: #fef2f2; border-radius: 6px; }
        .error-msg.visible { display: block; }
        
        /* ===== CTA SECTION ===== */
        .cta-section { background: linear-gradient(135deg, #2980b9 0%, #1a5276 100%); color: white; padding: 40px 25px; border-radius: 10px; text-align: center; margin-top: 25px; }
        .cta-section h3 { font-size: 1.4em; margin-bottom: 10px; }
        .cta-section p { opacity: 0.95; margin-bottom: 25px; }
        .cta-buttons { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .cta-btn { display: inline-flex; align-items: center; gap: 10px; padding: 14px 28px; border-radius: 50px; text-decoration: none; font-weight: 600; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; border: none; font-size: 1em; }
        .cta-btn.primary { background: white; color: #2980b9; }
        .cta-btn.secondary { background: transparent; border: 2px solid white; color: white; }
        .cta-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.25); }
        
        /* ===== FOOTER ===== */
        .contact-info { background: #2d3748; color: white; padding: 40px 20px; text-align: center; }
        .social-links { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        .social-links a { color: white; font-size: 2em; transition: color 0.3s, transform 0.3s; }
        .social-links a:hover { color: #0077b5; transform: scale(1.1); }
        
        /* ===== PDF TEMPLATE ===== */
        #pdf-content { padding: 25px; background: white; font-family: 'Segoe UI', sans-serif; }
        #pdf-content h1 { color: #2980b9; font-size: 1.5em; margin-bottom: 15px; }
        #pdf-content .pdf-header { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #e2e8f0; }
        #pdf-content .pdf-footer { margin-top: 25px; padding-top: 15px; border-top: 2px solid #e2e8f0; color: #2980b9; }
        #pdf-content .pdf-norm { padding: 10px; margin: 8px 0; border-left: 3px solid; background: #f8f9fa; }
        #pdf-content .pdf-norm.mandatory { border-color: #c53030; }
        #pdf-content .pdf-norm.recommended { border-color: #2980b9; }
        
        .spinner { display: inline-block; width: 18px; height: 18px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .navbar { flex-direction: column; gap: 15px; padding: 15px; }
            .navbar-menu { flex-wrap: wrap; justify-content: center; gap: 5px; }
            .navbar-menu a { padding: 8px 12px; font-size: 0.9em; }
            .lang-switch { margin-left: 0; padding-left: 0; border-left: none; margin-top: 10px; }
            .hero { padding: 35px 15px; }
            .hero h1 { font-size: 1.5em; }
            .hero p { font-size: 1em; }
            .container { padding: 20px 15px; }
            .section-card { padding: 18px; }
            .question-row { flex-direction: column; align-items: flex-start; gap: 6px; }
            .question-label { min-width: auto; }
            .question-hint { min-width: auto; }
            .question-select { width: 100%; }
            .results-summary { grid-template-columns: 1fr; }
            .cta-buttons { flex-direction: column; }
            .cta-btn { width: 100%; justify-content: center; }
            .contact-info { padding: 30px 15px; }
        }
    </style>
</head>
<body>
    <!-- ===== NAVBAR ===== -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">Agile<span>Vizion</span></a>
        <div class="navbar-menu">
            <a href="index.html">GRC Cybersecurity</a>
            <a href="service_management.html">Service Management</a>
            <a href="simulator.html" class="active">Simulator</a>
            <a href="why_me.html">Why me</a>
            <div class="lang-switch">
                <a href="../FR/simulator.html">FR</a>
                <a href="simulator.html" class="active-lang">EN</a>
            </div>
        </div>
    </nav>

    <!-- ===== HERO ===== -->
    <div class="hero">
        <h1><i class="fa-solid fa-shield-halved"></i> Which Cyber Regulations Apply to Your Organisation?</h1>
        <p>Answer 17 questions and discover your mandatory and recommended compliance frameworks.</p>
    </div>

    <!-- ===== MAIN CONTENT ===== -->
    <div class="container">
        
        <!-- PROGRESS BAR -->
        <div class="progress-container">
            <div class="progress-text">
                <span>Progress</span>
                <span id="progress-count">0/17 questions</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
            </div>
        </div>

        <!-- VALIDATION MESSAGE -->
        <div class="validation-msg" id="validation-msg">
            <i class="fa-solid fa-circle-exclamation"></i>
            <span>Please answer all questions to get accurate results.</span>
        </div>

        <!-- SECTION 1: GENERAL INFO -->
        <div class="section-card">
            <h2 class="section-title"><i class="fa-solid fa-building"></i> Section 1 ‚Äî General Information</h2>
            
            <div class="question-row">
                <span class="question-label">Q1. Number of employees<span class="required">*</span></span>
                <span class="question-hint">Permanent + fixed-term (excl. temps)</span>
                <select class="question-select" id="q1" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="<50">< 50</option>
                    <option value="50-249">50 - 249</option>
                    <option value="250-499">250 - 499</option>
                    <option value="500+">500+</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q2. Annual revenue<span class="required">*</span></span>
                <span class="question-hint">Net revenue last fiscal year</span>
                <select class="question-select" id="q2" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="<10M">< ‚Ç¨10M</option>
                    <option value="10-50M">‚Ç¨10M - ‚Ç¨50M</option>
                    <option value=">50M">> ‚Ç¨50M</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q3. Total balance sheet<span class="required">*</span></span>
                <span class="question-hint">Total Assets = Total Liabilities</span>
                <select class="question-select" id="q3" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="<10M">< ‚Ç¨10M</option>
                    <option value="10-43M">‚Ç¨10M - ‚Ç¨43M</option>
                    <option value=">43M">> ‚Ç¨43M</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q4. Headquarters / Zone<span class="required">*</span></span>
                <span class="question-hint">Location or clients in EU?</span>
                <select class="question-select" id="q4" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="EU">European Union</option>
                    <option value="nonEU_clients">Non-EU with EU clients</option>
                    <option value="nonEU_no">Non-EU, no EU clients</option>
                </select>
            </div>
        </div>

        <!-- SECTION 2: SECTOR -->
        <div class="section-card">
            <h2 class="section-title"><i class="fa-solid fa-industry"></i> Section 2 ‚Äî Industry Sector</h2>
            
            <div class="question-row">
                <span class="question-label">Q5. Main business sector<span class="required">*</span></span>
                <span class="question-hint">Activity generating most revenue</span>
                <select class="question-select" id="q5" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <optgroup label="Annex I - Highly Critical">
                        <option value="energy">Energy</option>
                        <option value="transport">Transport</option>
                        <option value="banking">Banking / Finance</option>
                        <option value="health">Healthcare</option>
                        <option value="water">Water / Environment</option>
                        <option value="telecom">Telecom / Cloud / Datacenter</option>
                        <option value="msp">MSP / MSSP / IT Services</option>
                        <option value="public">Public Administration</option>
                        <option value="space">Space</option>
                    </optgroup>
                    <optgroup label="Annex II - Critical">
                        <option value="postal">Postal Services</option>
                        <option value="waste">Waste Management</option>
                        <option value="chemistry">Chemistry</option>
                        <option value="food">Food & Agriculture</option>
                        <option value="manufacturing">Manufacturing</option>
                        <option value="digital">Digital Provider (marketplace, social)</option>
                        <option value="research">Research</option>
                    </optgroup>
                    <optgroup label="Other">
                        <option value="insurance">Insurance / Mutual</option>
                        <option value="retail">Retail / E-commerce</option>
                        <option value="services">Business Services</option>
                        <option value="other">Other</option>
                    </optgroup>
                </select>
            </div>
        </div>

        <!-- SECTION 3: DATA -->
        <div class="section-card">
            <h2 class="section-title"><i class="fa-solid fa-database"></i> Section 3 ‚Äî Data & Processing</h2>
            
            <div class="question-row">
                <span class="question-label">Q6. Process personal data?<span class="required">*</span></span>
                <span class="question-hint">Name, email, phone, IP, cookies, HR...</span>
                <select class="question-select" id="q6" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q7. Process health data?<span class="required">*</span></span>
                <span class="question-hint">Patient records, medical data...</span>
                <select class="question-select" id="q7" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q8. Process card data (PAN)?<span class="required">*</span></span>
                <span class="question-hint">Not if Stripe/PayPal hides PAN</span>
                <select class="question-select" id="q8" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes - we see/store card numbers</option>
                    <option value="no">No - we use Stripe/PayPal/etc.</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q9. Card transactions/year?<span class="required">*</span></span>
                <span class="question-hint">If you process cards</span>
                <select class="question-select" id="q9" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="na">N/A - no card processing</option>
                    <option value="<20k">< 20K (Level 4 - SAQ)</option>
                    <option value="20k-1m">20K - 1M (Level 3 - SAQ)</option>
                    <option value="1m-6m">1M - 6M (Level 2 - SAQ + ASV)</option>
                    <option value=">6m">> 6M (Level 1 - QSA audit)</option>
                </select>
            </div>
        </div>

        <!-- SECTION 4: REGULATIONS -->
        <div class="section-card">
            <h2 class="section-title"><i class="fa-solid fa-gavel"></i> Section 4 ‚Äî Regulations & Client Requirements</h2>
            
            <div class="question-row">
                <span class="question-label">Q10. Regulated by AMF/ACPR?<span class="required">*</span></span>
                <span class="question-hint">Banking/insurance license, SGP, OPCVM...</span>
                <select class="question-select" id="q10" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes - we have a financial license</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q11. ICT provider for financial entities?<span class="required">*</span></span>
                <span class="question-hint">IT subcontractor for banks/insurers</span>
                <select class="question-select" id="q11" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes - we provide IT to regulated entities</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q12. Provide IT/Cloud services?<span class="required">*</span></span>
                <span class="question-hint">MSP, SaaS, hosting, consulting...</span>
                <select class="question-select" id="q12" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q13. Host health data for third parties?<span class="required">*</span></span>
                <span class="question-hint">For clients (hospitals, clinics...)</span>
                <select class="question-select" id="q13" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes - we host client health data</option>
                    <option value="no">No (or only our own data)</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q14. Work with US DoD?<span class="required">*</span></span>
                <span class="question-hint">Department of Defense contracts</span>
                <select class="question-select" id="q14" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q15. Clients require ISO 27001?<span class="required">*</span></span>
                <span class="question-hint">RFPs, large accounts, contracts</span>
                <select class="question-select" id="q15" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes - contractually required</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q16. Clients require SOC 2?<span class="required">*</span></span>
                <span class="question-hint">US clients, Fortune 500, SaaS B2B</span>
                <select class="question-select" id="q16" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes - US clients require it</option>
                    <option value="no">No</option>
                </select>
            </div>
            
            <div class="question-row">
                <span class="question-label">Q17. Critical activities to protect?<span class="required">*</span></span>
                <span class="question-hint">Business continuity requirements</span>
                <select class="question-select" id="q17" onchange="updateProgress()">
                    <option value="">‚Äî Select ‚Äî</option>
                    <option value="yes">Yes - we have critical operations</option>
                    <option value="no">No</option>
                </select>
            </div>
        </div>

        <!-- BUTTON -->
        <button class="btn-calculate" onclick="calculate()" id="btn-calc">
            <i class="fa-solid fa-magnifying-glass-chart"></i>
            Analyze My Compliance Requirements
        </button>

        <!-- ===== RESULTS ===== -->
        <div class="results-section" id="results">
            <div class="section-card">
                <h2 class="section-title"><i class="fa-solid fa-clipboard-check"></i> Your Applicable Frameworks</h2>
                
                <div class="results-summary">
                    <div class="summary-card mandatory">
                        <div class="summary-number" id="cnt-mand">0</div>
                        <div class="summary-label">Mandatory / Required</div>
                    </div>
                    <div class="summary-card recommended">
                        <div class="summary-number" id="cnt-rec">0</div>
                        <div class="summary-label">Recommended</div>
                    </div>
                </div>
                
                <div id="results-container"></div>
            </div>

            <!-- PDF SECTION -->
            <div class="pdf-section">
                <h4><i class="fa-solid fa-file-pdf"></i> Get Your Report by Email</h4>
                <p>Enter your details to receive your personalized compliance assessment PDF.</p>
                <div class="form-row">
                    <input type="text" class="form-input" id="company" placeholder="Company name">
                    <input type="email" class="form-input" id="email" placeholder="your@email.com">
                </div>
                <div class="form-row">
                    <button class="btn-send" onclick="sendReport()" id="btn-send">
                        <i class="fa-solid fa-paper-plane"></i>
                        Send My Report
                    </button>
                </div>
                <p class="success-msg" id="success">‚úÖ Report downloaded! A notification has been sent to AgileVizion.</p>
                <p class="error-msg" id="error">‚ùå Error. Please try again.</p>
            </div>

            <!-- CTA -->
            <div class="cta-section">
                <h3>Need Help Getting Compliant?</h3>
                <p>Let's discuss your situation and build a roadmap together ‚Äî 30-min call, free, no commitment.</p>
                <div class="cta-buttons">
                    <a href="" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/emmanuel-genesteix-agilevizion/diagnostic-agilevizion'});return false;" class="cta-btn primary">
                        <i class="fa-solid fa-calendar-check"></i>
                        Book a Call
                    </a>
                    <a href="mailto:emmanuel.genesteix@agilevizion.com" class="cta-btn secondary">
                        <i class="fa-solid fa-envelope"></i>
                        Send Email
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== FOOTER ===== -->
    <div class="contact-info">
        <div style="max-width: 1200px; margin: 0 auto;">
            <h2 style="margin-bottom: 20px;">Contact me</h2>
            <p style="font-size: 1.2em; margin-bottom: 10px;">üì± +352.661.78.08.07 ¬∑ ‚úâÔ∏è <a href="mailto:emmanuel.genesteix@agilevizion.com" style="color: white;">emmanuel.genesteix@agilevizion.com</a></p>
            <p style="font-size: 1.2em;">üìç Luxembourg (Europe-wide interventions)</p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/genesteix-emmanuel/" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin"></i></a>
            </div>
        </div>
    </div>

    <!-- ===== PDF TEMPLATE (hidden) ===== -->
    <div style="position:absolute;left:-9999px;">
        <div id="pdf-content">
            <h1>üéØ Cyber Compliance Assessment ‚Äî AgileVizion</h1>
            <div class="pdf-header">
                <p><strong>Company:</strong> <span id="pdf-company"></span></p>
                <p><strong>Email:</strong> <span id="pdf-email"></span></p>
                <p><strong>Date:</strong> <span id="pdf-date"></span></p>
            </div>
            <div id="pdf-results"></div>
            <div class="pdf-footer">
                <p><strong>AgileVizion</strong> ‚Äî GRC & Cybersecurity Consulting</p>
                <p>üìß emmanuel.genesteix@agilevizion.com | üåê www.agilevizion.com</p>
                <p style="margin-top:10px;">Need help? Book a free call: calendly.com/emmanuel-genesteix-agilevizion</p>
            </div>
        </div>
    </div>

    <script>
        // ========== NORMS CONFIG ==========
        const NORMS = {
            rgpd: { 
                name: "GDPR", 
                fullName: "General Data Protection Regulation",
                source: "Regulation (EU) 2016/679",
                sanctions: "‚Ç¨20M or 4% global revenue",
                deadline: "In force"
            },
            dora: { 
                name: "DORA", 
                fullName: "Digital Operational Resilience Act",
                source: "Regulation (EU) 2022/2554",
                sanctions: "License withdrawal + financial sanctions",
                deadline: "January 17, 2025"
            },
            nis2: { 
                name: "NIS 2", 
                fullName: "Network and Information Security Directive",
                source: "Directive (EU) 2022/2555",
                sanctions: "‚Ç¨10M/2% (Essential) or ‚Ç¨7M/1.4% (Important)",
                deadline: "October 17, 2024"
            },
            pcidss: { 
                name: "PCI-DSS", 
                fullName: "Payment Card Industry Data Security Standard",
                source: "PCI-DSS v4.0 (PCI SSC)",
                sanctions: "Network fines + loss of card processing",
                deadline: "In force (v4.0)"
            },
            hds: { 
                name: "HDS", 
                fullName: "H√©bergeur de Donn√©es de Sant√© (France)",
                source: "Code de la Sant√© Publique",
                sanctions: "Criminal sanctions + CNIL fines",
                deadline: "In force"
            },
            iso27001: { 
                name: "ISO 27001", 
                fullName: "Information Security Management System",
                source: "ISO/IEC 27001:2022",
                sanctions: "Loss of contracts and market access",
                deadline: "Voluntary"
            },
            iso20000: { 
                name: "ISO 20000", 
                fullName: "IT Service Management System",
                source: "ISO/IEC 20000-1:2018",
                sanctions: "Commercial differentiation loss",
                deadline: "Voluntary"
            },
            soc2: { 
                name: "SOC 2", 
                fullName: "Service Organization Control 2",
                source: "AICPA TSP Section 100",
                sanctions: "Loss of US/international clients",
                deadline: "Voluntary"
            },
            iso22301: { 
                name: "ISO 22301", 
                fullName: "Business Continuity Management",
                source: "ISO 22301:2019",
                sanctions: "Business interruption risk",
                deadline: "Voluntary"
            },
            cmmc: { 
                name: "CMMC", 
                fullName: "Cybersecurity Maturity Model Certification",
                source: "CMMC 2.0 / 32 CFR Part 170",
                sanctions: "Exclusion from DoD contracts",
                deadline: "Required for DoD"
            }
        };

        // NIS 2 sectors
        const NIS2_ANNEX1 = ['energy','transport','banking','health','water','telecom','msp','public','space'];
        const NIS2_ANNEX2 = ['postal','waste','chemistry','food','manufacturing','digital','research'];
        const NIS2_ALL = [...NIS2_ANNEX1, ...NIS2_ANNEX2];
        
        // Sensitive sectors for ISO 27001 recommendation
        const SENSITIVE_SECTORS = ['banking','insurance','health','telecom','msp'];
        
        // IT sectors for ISO 20000/SOC2
        const IT_SECTORS = ['telecom','msp'];

        let results = null;

        // ========== PROGRESS UPDATE ==========
        function updateProgress() {
            let answered = 0;
            for (let i = 1; i <= 17; i++) {
                const val = document.getElementById('q'+i).value;
                const el = document.getElementById('q'+i);
                if (val) {
                    answered++;
                    el.classList.remove('error');
                    el.classList.add('valid');
                } else {
                    el.classList.remove('valid');
                }
            }
            
            const pct = Math.round((answered / 17) * 100);
            document.getElementById('progress-fill').style.width = pct + '%';
            document.getElementById('progress-count').textContent = answered + '/17 questions';
        }

        // ========== VALIDATION ==========
        function validateAll() {
            let valid = true;
            let firstEmpty = null;
            
            for (let i = 1; i <= 17; i++) {
                const el = document.getElementById('q'+i);
                if (!el.value) {
                    el.classList.add('error');
                    valid = false;
                    if (!firstEmpty) firstEmpty = el;
                } else {
                    el.classList.remove('error');
                }
            }
            
            if (!valid) {
                document.getElementById('validation-msg').classList.add('visible');
                firstEmpty.focus();
                firstEmpty.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else {
                document.getElementById('validation-msg').classList.remove('visible');
            }
            
            return valid;
        }

        // ========== CALCULATION ==========
        function calculate() {
            if (!validateAll()) return;

            const a = {};
            for (let i = 1; i <= 17; i++) a['q'+i] = document.getElementById('q'+i).value;

            results = {};

            // ===== GDPR =====
            // Applies if processing personal data AND (EU-based OR EU clients/users)
            if (a.q6 === 'yes' && (a.q4 === 'EU' || a.q4 === 'nonEU_clients')) {
                results.rgpd = { st: 'mandatory', why: 'Processing personal data of EU residents' };
            }

            // ===== DORA =====
            // ONLY for regulated financial entities OR critical ICT providers to financial sector
            if (a.q10 === 'yes') {
                results.dora = { st: 'mandatory', why: 'Regulated financial entity (AMF/ACPR license)' };
            } else if (a.q11 === 'yes') {
                results.dora = { st: 'mandatory', why: 'Critical ICT provider for financial entities' };
            }

            // ===== NIS 2 =====
            // 3 cumulative criteria: Sector + Size + EU
            const isNis2Sector = NIS2_ALL.includes(a.q5);
            const isEE = ['250-499','500+'].includes(a.q1) || a.q2 === '>50M' || a.q3 === '>43M';
            const isEI = ['50-249'].includes(a.q1) || a.q2 === '10-50M' || a.q3 === '10-43M';
            const isEU = a.q4 === 'EU' || a.q4 === 'nonEU_clients';
            
            if (isNis2Sector && (isEE || isEI) && isEU) {
                const entityType = isEE ? 'Essential Entity' : 'Important Entity';
                results.nis2 = { st: 'mandatory', why: `Critical sector + Size threshold met (${entityType}) + EU` };
            }

            // ===== PCI-DSS =====
            // Applies if you see/store/transmit card numbers (PAN)
            if (a.q8 === 'yes') {
                let level = '';
                if (a.q9 === '>6m') level = ' (Level 1 - QSA audit required)';
                else if (a.q9 === '1m-6m') level = ' (Level 2 - SAQ + ASV scan)';
                else if (a.q9 === '20k-1m') level = ' (Level 3 - SAQ)';
                else if (a.q9 === '<20k') level = ' (Level 4 - SAQ simplified)';
                results.pcidss = { st: 'mandatory', why: 'Processing/storing card data (PAN)' + level };
            }

            // ===== HDS =====
            // ONLY if hosting health data FOR THIRD PARTIES (clients)
            if (a.q13 === 'yes') {
                results.hds = { st: 'mandatory', why: 'Hosting health data for third parties (clients)' };
            }

            // ===== ISO 27001 =====
            // Required if clients demand it, Recommended for sensitive sectors
            if (a.q15 === 'yes') {
                results.iso27001 = { st: 'mandatory', why: 'Contractually required by clients' };
            } else if (SENSITIVE_SECTORS.includes(a.q5) || a.q11 === 'yes') {
                results.iso27001 = { st: 'recommended', why: 'Highly recommended for sensitive sector / financial subcontractor' };
            }

            // ===== ISO 20000 =====
            // Recommended for IT service providers
            if (a.q12 === 'yes') {
                results.iso20000 = { st: 'recommended', why: 'IT/Cloud service provider - commercial differentiation' };
            }

            // ===== SOC 2 =====
            // Required if US clients demand it, Recommended for SaaS/Cloud B2B
            if (a.q16 === 'yes') {
                results.soc2 = { st: 'mandatory', why: 'Required by US clients' };
            } else if (a.q12 === 'yes' && IT_SECTORS.includes(a.q5)) {
                results.soc2 = { st: 'recommended', why: 'SaaS/Cloud B2B - often requested by international clients' };
            }

            // ===== ISO 22301 =====
            // Recommended if critical activities OR in critical sector (often required by DORA/NIS2)
            if (a.q17 === 'yes') {
                results.iso22301 = { st: 'recommended', why: 'Critical activities identified - business continuity essential' };
            } else if (['banking','health','energy'].includes(a.q5)) {
                results.iso22301 = { st: 'recommended', why: 'Critical sector - continuity requirements (DORA/NIS2 include BCP obligations)' };
            }

            // ===== CMMC =====
            // Mandatory if working with US DoD
            if (a.q14 === 'yes') {
                results.cmmc = { st: 'mandatory', why: 'Working with US Department of Defense' };
            }

            showResults(results);
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function showResults(r) {
            // Separate mandatory and recommended
            const mandatory = [];
            const recommended = [];
            
            Object.entries(r).forEach(([k, v]) => {
                const norm = { ...NORMS[k], key: k, ...v };
                if (v.st === 'mandatory') mandatory.push(norm);
                else if (v.st === 'recommended') recommended.push(norm);
            });

            document.getElementById('cnt-mand').textContent = mandatory.length;
            document.getElementById('cnt-rec').textContent = recommended.length;

            let html = '';

            // Mandatory section
            if (mandatory.length > 0) {
                html += `<div class="results-category">
                    <h3 class="mandatory-title"><i class="fa-solid fa-circle-exclamation"></i> Mandatory / Required Frameworks</h3>`;
                mandatory.forEach(n => {
                    html += `<div class="norm-card mandatory">
                        <div class="norm-card-header">
                            <span class="norm-name">${n.name} <small style="font-weight:400;color:#718096;">‚Äî ${n.fullName}</small></span>
                            <span class="norm-badge mandatory">MANDATORY</span>
                        </div>
                        <div class="norm-why"><i class="fa-solid fa-check" style="color:#27ae60;margin-right:5px;"></i> ${n.why}</div>
                        <div class="norm-sanction"><i class="fa-solid fa-triangle-exclamation"></i> Penalties: ${n.sanctions}</div>
                    </div>`;
                });
                html += `</div>`;
            }

            // Recommended section
            if (recommended.length > 0) {
                html += `<div class="results-category">
                    <h3 class="recommended-title"><i class="fa-solid fa-thumbs-up"></i> Recommended Frameworks</h3>`;
                recommended.forEach(n => {
                    html += `<div class="norm-card recommended">
                        <div class="norm-card-header">
                            <span class="norm-name">${n.name} <small style="font-weight:400;color:#718096;">‚Äî ${n.fullName}</small></span>
                            <span class="norm-badge recommended">RECOMMENDED</span>
                        </div>
                        <div class="norm-why"><i class="fa-solid fa-lightbulb" style="color:#f39c12;margin-right:5px;"></i> ${n.why}</div>
                        <div class="norm-sanction"><i class="fa-solid fa-info-circle"></i> Stakes: ${n.sanctions}</div>
                    </div>`;
                });
                html += `</div>`;
            }

            // No results
            if (mandatory.length === 0 && recommended.length === 0) {
                html = `<div class="no-results">
                    <i class="fa-solid fa-circle-check"></i>
                    <p><strong>Good news!</strong> Based on your answers, no specific cyber regulations appear to apply to your organisation.</p>
                    <p style="margin-top:10px;">However, general security best practices are always recommended.</p>
                </div>`;
            }

            document.getElementById('results-container').innerHTML = html;
            document.getElementById('results').classList.add('visible');
        }

        // ========== PDF & EMAIL ==========
        async function sendReport() {
            const company = document.getElementById('company').value.trim();
            const email = document.getElementById('email').value.trim();
            
            if (!company) { alert('Please enter your company name'); document.getElementById('company').focus(); return; }
            if (!email || !email.includes('@')) { alert('Please enter a valid email'); document.getElementById('email').focus(); return; }

            const btn = document.getElementById('btn-send');
            const orig = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner"></span>';
            
            document.getElementById('success').classList.remove('visible');
            document.getElementById('error').classList.remove('visible');

            try {
                // Separate results
                const mandatory = [];
                const recommended = [];
                Object.entries(results).forEach(([k, v]) => {
                    const norm = { ...NORMS[k], ...v };
                    if (v.st === 'mandatory') mandatory.push(norm);
                    else if (v.st === 'recommended') recommended.push(norm);
                });

                // Build PDF content
                let pdfHtml = '';
                
                if (mandatory.length > 0) {
                    pdfHtml += `<h3 style="color:#c53030;margin-top:20px;">üî¥ MANDATORY FRAMEWORKS (${mandatory.length})</h3>`;
                    mandatory.forEach(n => {
                        pdfHtml += `<div class="pdf-norm mandatory">
                            <strong>${n.name}</strong> ‚Äî ${n.fullName}<br>
                            <span style="color:#27ae60;">‚úì ${n.why}</span><br>
                            <span style="color:#c53030;">‚ö† Penalties: ${n.sanctions}</span>
                        </div>`;
                    });
                }
                
                if (recommended.length > 0) {
                    pdfHtml += `<h3 style="color:#2980b9;margin-top:20px;">üîµ RECOMMENDED FRAMEWORKS (${recommended.length})</h3>`;
                    recommended.forEach(n => {
                        pdfHtml += `<div class="pdf-norm recommended">
                            <strong>${n.name}</strong> ‚Äî ${n.fullName}<br>
                            <span style="color:#f39c12;">üí° ${n.why}</span><br>
                            <span style="color:#718096;">‚Ñπ Stakes: ${n.sanctions}</span>
                        </div>`;
                    });
                }

                if (mandatory.length === 0 && recommended.length === 0) {
                    pdfHtml = `<p style="text-align:center;padding:20px;color:#27ae60;"><strong>‚úì No specific regulations identified based on your profile.</strong></p>`;
                }

                // Prepare PDF
                document.getElementById('pdf-company').textContent = company;
                document.getElementById('pdf-email').textContent = email;
                document.getElementById('pdf-date').textContent = new Date().toLocaleDateString();
                document.getElementById('pdf-results').innerHTML = pdfHtml;

                const el = document.getElementById('pdf-content');
                el.style.display = 'block';

                // Generate & download PDF
                await html2pdf().set({
                    margin: 10,
                    filename: `AgileVizion_Compliance_${company.replace(/[^a-zA-Z0-9]/g, '_')}.pdf`,
                    image: { type: 'jpeg', quality: 0.95 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                }).from(el).save();

                el.style.display = 'none';

                // ========== NOTIFY CONSULTANT ==========
                const summary = [
                    ...mandatory.map(n => `üî¥ ${n.name}: ${n.why}`),
                    ...recommended.map(n => `üîµ ${n.name}: ${n.why}`)
                ].join('\n');

                const mailSubject = encodeURIComponent(`üéØ New Simulator Lead: ${company}`);
                const mailBody = encodeURIComponent(
`New lead from Cyber Compliance Simulator

üìß Email: ${email}
üè¢ Company: ${company}
üìÖ Date: ${new Date().toLocaleString()}

üìä RESULTS:
${summary || 'No frameworks identified'}

---
Mandatory: ${mandatory.length} | Recommended: ${recommended.length}
`);
                
                // Silent mailto trigger
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = `mailto:emmanuel.genesteix@agilevizion.com?subject=${mailSubject}&body=${mailBody}`;
                document.body.appendChild(iframe);
                setTimeout(() => document.body.removeChild(iframe), 2000);

                document.getElementById('success').classList.add('visible');

            } catch (e) {
                console.error('Error:', e);
                document.getElementById('error').classList.add('visible');
            } finally {
                btn.disabled = false;
                btn.innerHTML = orig;
            }
        }

        // Initialize progress
        updateProgress();
    </script>
</body>
</html>
