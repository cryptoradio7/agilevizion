<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="simulator.title">Simulateur Compliance - AgileVizion</title>
    <link rel="canonical" href="https://agilevizion.com/pages_specs/simulator.html" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Common Styles -->
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/themes.css?v=2.3">
    <link rel="stylesheet" href="../css/responsive.css">
    <!-- Simulator CSS -->
    <link rel="stylesheet" href="../css/simulator.css?v=2.5">
    
    <!-- Calendly Widget -->
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
    
    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body class="theme-grc" data-page="simulator" data-page-title="simulator.title">
    <div id="header-placeholder"></div>
    
    <!-- HERO -->
    <section class="sim-hero">
        <h1><i class="fa-solid fa-shield-halved"></i> <span data-i18n="simulator.hero_title">Quelles réglementations cyber s'appliquent à vous ?</span></h1>
        <p data-i18n="simulator.hero_text" data-i18n-html>Répondez à quelques questions et découvrez immédiatement quels référentiels sont <strong>applicables</strong> ou <strong>recommandés</strong> pour votre organisation.</p>
    </section>

    <div class="sim-container">
        <!-- QUESTIONS CARD -->
        <div class="sim-card" id="questions-card">
            <div class="sim-card-header">
                <h2 class="sim-card-title"><i class="fa-solid fa-building"></i> <span data-i18n="simulator.organization_title">Votre organisation</span></h2>
                <button class="btn-reset" onclick="resetSimulator()"><i class="fa-solid fa-rotate-left"></i> <span data-i18n="simulator.btn_reset">Réinitialiser</span></button>
            </div>
            
            <div class="disclaimer">
                <i class="fa-solid fa-triangle-exclamation"></i>
                <span data-i18n="simulator.disclaimer">Ce simulateur fournit une indication générale et ne constitue pas un avis juridique.</span>
            </div>

            <!-- Q1: Location -->
            <div class="question-group" id="group-q1">
                <label class="question-label" data-i18n="simulator.q1_label" data-i18n-html>Où est situé votre siège social / activité principale ?<span class="required">*</span></label>
                <select class="question-select" id="q1_location" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="eu" data-i18n="simulator.q1_option_eu">Siège dans l'Union Européenne</option>
                    <option value="eu_clients" data-i18n="simulator.q1_option_eu_clients">Hors UE mais clients/utilisateurs dans l'UE</option>
                    <option value="non_eu" data-i18n="simulator.q1_option_non_eu">Hors UE, aucune activité UE</option>
                </select>
            </div>

            <!-- Q2: Sector -->
            <div class="question-group" id="group-q2">
                <label class="question-label" data-i18n="simulator.q2_label" data-i18n-html>Quel est votre secteur d'activité principal ?<span class="required">*</span></label>
                <select class="question-select" id="q2_sector" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <optgroup label="NIS 2 Annexe I — Hautement critiques">
                        <option value="energy">Énergie (électricité, gaz, pétrole, hydrogène)</option>
                        <option value="transport">Transports (aérien, ferroviaire, maritime, routier)</option>
                        <option value="banking">Banque / Établissements de crédit</option>
                        <option value="financial_infra">Infrastructures des marchés financiers</option>
                        <option value="health">Santé (hôpitaux, labos, pharma)</option>
                        <option value="water">Eau potable / Eaux usées</option>
                        <option value="digital_infra">Infrastructure numérique (IXP, DNS, TLD, datacenter)</option>
                        <option value="ict_b2b">Services TIC B2B (MSP, MSSP, infogérance)</option>
                        <option value="public_admin">Administrations publiques</option>
                        <option value="space">Espace</option>
                    </optgroup>
                    <optgroup label="NIS 2 Annexe II — Secteurs critiques">
                        <option value="postal">Services postaux et courrier</option>
                        <option value="waste">Gestion des déchets</option>
                        <option value="chemistry">Chimie (fabrication, production)</option>
                        <option value="food">Agroalimentaire (production, distribution)</option>
                        <option value="manufacturing">Fabrication (médical, électronique, machines, véhicules)</option>
                        <option value="digital_providers">Fournisseurs numériques (marketplaces, moteurs, réseaux sociaux)</option>
                        <option value="research">Organismes de recherche</option>
                    </optgroup>
                    <optgroup label="Secteur financier (DORA)">
                        <option value="insurance">Assurance / Réassurance / Mutuelle</option>
                        <option value="investment">Entreprise d'investissement / SGP / OPCVM</option>
                        <option value="crypto">Prestataire crypto (agrément MiCA)</option>
                        <option value="crowdfunding">Plateforme de crowdfunding</option>
                        <option value="rating">Agence de notation</option>
                    </optgroup>
                    <optgroup label="Autres secteurs">
                        <option value="retail">Commerce / E-commerce</option>
                        <option value="services">Services aux entreprises / Conseil</option>
                        <option value="other">Autre secteur</option>
                    </optgroup>
                </select>
            </div>

            <!-- Q3: Size -->
            <div class="question-group" id="group-q3">
                <label class="question-label" data-i18n="simulator.q3_label" data-i18n-html>Quelle est la taille de votre organisation ?<span class="required">*</span></label>
                <select class="question-select" id="q3_size" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="small">Petite : moins de 50 employés ET CA &lt;10M€ ET bilan &lt;10M€</option>
                    <option value="medium">Moyenne : 50-249 employés OU CA 10-50M€ OU bilan 10-43M€</option>
                    <option value="large">Grande : 250+ employés OU CA &gt;50M€ OU bilan &gt;43M€</option>
                </select>
            </div>

            <!-- Q4: Personal Data -->
            <div class="question-group" id="group-q4">
                <label class="question-label" data-i18n="simulator.q4_label" data-i18n-html>Traitez-vous des données personnelles ?<span class="required">*</span></label>
                <select class="question-select" id="q4_personal_data" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui</option>
                    <option value="no">Non</option>
                </select>
            </div>

            <!-- Q5: Regulated -->
            <div class="question-group" id="group-q5">
                <label class="question-label" data-i18n="simulator.q5_label" data-i18n-html>Détenez-vous un agrément financier (AMF, ACPR, CSSF...) ?<span class="required">*</span></label>
                <select class="question-select" id="q5_regulated" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui — Entité régulée</option>
                    <option value="no">Non</option>
                </select>
            </div>

            <!-- Q6: IT Services -->
            <div class="question-group" id="group-q6">
                <label class="question-label" data-i18n="simulator.q6_label" data-i18n-html>Fournissez-vous des services IT/Cloud à des clients ?<span class="required">*</span></label>
                <select class="question-select" id="q6_it_services" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui</option>
                    <option value="no">Non</option>
                </select>
            </div>

            <!-- Conditional: TIC Provider -->
            <div class="conditional-group question-group" id="cond-tic">
                <label class="question-label" data-i18n="simulator.q7_label">Êtes-vous prestataire TIC pour des entités financières régulées ?</label>
                <select class="question-select" id="q7_tic_provider" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui</option>
                    <option value="no">Non</option>
                </select>
            </div>

            <!-- Conditional: HDS -->
            <div class="conditional-group question-group" id="cond-hds">
                <label class="question-label" data-i18n="simulator.q8_label">Hébergez-vous des données de santé pour des tiers (clients) ?</label>
                <select class="question-select" id="q8_hds" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui</option>
                    <option value="no">Non</option>
                </select>
            </div>

            <!-- Conditional: PCI -->
            <div class="conditional-group question-group" id="cond-pci">
                <label class="question-label" data-i18n="simulator.q9_label">Stockez/traitez-vous des numéros de cartes bancaires (PAN) ?</label>
                <select class="question-select" id="q9_pci" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui</option>
                    <option value="no">Non (Stripe/PayPal gère les paiements)</option>
                </select>
            </div>

            <!-- US Section -->
            <div class="section-title"><i class="fa-solid fa-flag-usa"></i> <span data-i18n="simulator.us_section">Activités aux États-Unis</span></div>

            <!-- Q10: US Activity -->
            <div class="question-group" id="group-q10">
                <label class="question-label" data-i18n="simulator.q10_label" data-i18n-html>Avez-vous des activités ou clients aux États-Unis ?<span class="required">*</span></label>
                <select class="question-select" id="q10_us_activity" onchange="handleChange(this)">
                    <option value="yes">Oui</option>
                    <option value="no" selected>Non</option>
                </select>
            </div>

            <!-- Conditional: US Certs -->
            <div class="conditional-group question-group" id="cond-us-certs">
                <label class="question-label" data-i18n="simulator.q10a_label">Vos clients US exigent-ils des certifications (ISO 27001 / SOC 2) ?</label>
                <select class="question-select" id="q10a_us_certs" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="iso27001">ISO 27001 exigé</option>
                    <option value="soc2">SOC 2 exigé</option>
                    <option value="both">Les deux</option>
                    <option value="no">Non / Pas encore</option>
                </select>
            </div>

            <!-- Conditional: DoD -->
            <div class="conditional-group question-group" id="cond-us-dod">
                <label class="question-label" data-i18n="simulator.q10b_label">Travaillez-vous avec le Département de la Défense US (DoD) ?</label>
                <select class="question-select" id="q10b_dod" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui — Contrats directs ou sous-traitance</option>
                    <option value="no">Non</option>
                </select>
            </div>

            <!-- Continuity Section -->
            <div class="section-title"><i class="fa-solid fa-arrows-rotate"></i> <span data-i18n="simulator.continuity_section">Continuité d'activité</span></div>

            <!-- Q11: Continuity -->
            <div class="question-group" id="group-q11">
                <label class="question-label" data-i18n="simulator.q11_label" data-i18n-html>Avez-vous des activités critiques nécessitant un plan de continuité ?<span class="required">*</span></label>
                <select class="question-select" id="q11_continuity" onchange="handleChange(this)">
                    <option value="">— <span data-i18n="simulator.select">Sélectionnez</span> —</option>
                    <option value="yes">Oui</option>
                    <option value="no">Non</option>
                </select>
                <div class="question-note warning" id="note-continuity" style="display:none;">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    <span data-i18n="simulator.continuity_note">NIS 2 / DORA impose des mesures de continuité d'activité (Art. 21). Un plan sera requis même si vous n'en avez pas encore.</span>
                </div>
            </div>

            <!-- Analyze Button -->
            <button class="btn-primary" id="btn-analyze" onclick="analyzeProfile()" disabled>
                <i class="fa-solid fa-magnifying-glass-chart"></i> <span data-i18n="simulator.btn_analyze">Analyser mon profil</span>
            </button>
        </div>

        <!-- PROFILE CARD -->
        <div class="profile-card" id="profile-card">
            <div class="profile-header">
                <div class="profile-icon" id="profile-icon"></div>
                <div>
                    <div class="profile-title" id="profile-title">Moyenne entreprise</div>
                    <div class="profile-subtitle" id="profile-subtitle">50-249 employés ou CA 10-50M€</div>
                </div>
            </div>
            <div class="profile-tags" id="profile-tags"></div>
        </div>

        <!-- RESULTS SECTION -->
        <section class="results-section" id="results-section">
            <div class="sim-card">
                <h2 class="sim-card-title"><i class="fa-solid fa-clipboard-check"></i> <span data-i18n="simulator.results_title">Votre diagnostic compliance</span></h2>
                
                <div class="results-summary">
                    <div class="summary-card mandatory">
                        <div class="summary-number" id="count-mandatory">0</div>
                        <div class="summary-label" data-i18n="simulator.mandatory_label">Réglementation(s) applicable(s)</div>
                    </div>
                    <div class="summary-card recommended">
                        <div class="summary-number" id="count-recommended">0</div>
                        <div class="summary-label" data-i18n="simulator.recommended_label">Recommandation(s)</div>
                    </div>
                </div>

                <div id="results-container"></div>
            </div>

            <!-- PDF Section -->
            <div class="pdf-section">
                <h4><i class="fa-solid fa-file-pdf"></i> <span data-i18n="simulator.pdf_title">Télécharger votre rapport</span></h4>
                <p data-i18n="simulator.pdf_text">Recevez un PDF récapitulatif avec toutes les réglementations, risques et échéances.</p>
                <div class="form-row">
                    <input type="text" id="input-company" class="form-input" data-i18n-placeholder="simulator.input_company" placeholder="Nom de votre entreprise *" oninput="checkPdfFormValid()">
                    <input type="email" id="input-email" class="form-input" data-i18n-placeholder="simulator.input_email" placeholder="Votre email *" oninput="checkPdfFormValid()">
                    <button class="btn-download" id="btn-pdf" onclick="generatePDF()" disabled><i class="fa-solid fa-download"></i> <span data-i18n="simulator.btn_download">Télécharger PDF</span></button>
                </div>
                <div class="msg-success" id="msg-success"><i class="fa-solid fa-circle-check"></i> <span data-i18n="simulator.pdf_success">Rapport téléchargé !</span></div>
                <div class="msg-error" id="msg-error"><i class="fa-solid fa-circle-xmark"></i> <span data-i18n="simulator.pdf_error">Erreur, réessayez.</span></div>
            </div>

            <!-- CTA Section -->
            <div class="cta-section">
                <h3><i class="fa-solid fa-handshake"></i> <span data-i18n="simulator.cta_title">Besoin d'accompagnement ?</span></h3>
                <p data-i18n="simulator.cta_text">Obtenez un audit personnalisé et une feuille de route pour votre mise en conformité.</p>
                <div class="cta-buttons">
                    <button class="cta-btn primary" onclick="openCalendly()"><i class="fa-solid fa-video"></i> <span data-i18n="common.book_slot">Réserver un appel (30 min)</span></button>
                    <a href="mailto:emmanuel.genesteix@agilevizion.com" class="cta-btn secondary"><i class="fa-solid fa-envelope"></i> <span data-i18n="simulator.cta_contact">Me contacter</span></a>
                </div>
            </div>
        </section>
    </div>

    <!-- PDF TEMPLATE (hidden) -->
    <div id="pdf-template" style="background: white; color: #1a202c; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 25px;">
        <div class="pdf-header" style="margin-bottom: 25px; padding-bottom: 15px; border-bottom: 3px solid #2563eb; color: #1a202c;">
            <h1 style="color: #2563eb; font-size: 1.5em; margin-bottom: 5px;">Diagnostic Compliance</h1>
            <p style="color: #2563eb; font-size: 1.1em; margin: 5px 0; color: #2563eb;">AgileVizion — GRC et Cybersécurité</p>
            <p style="color: #1a202c; margin: 5px 0;"><strong style="color: #1a202c;">Entreprise :</strong> <span id="pdf-company" style="color: #1a202c;"></span></p>
            <p style="color: #1a202c; margin: 5px 0;"><strong style="color: #1a202c;">Email :</strong> <span id="pdf-email" style="color: #1a202c;"></span></p>
            <p style="color: #1a202c; margin: 5px 0;"><strong style="color: #1a202c;">Date :</strong> <span id="pdf-date" style="color: #1a202c;"></span></p>
            <p style="font-size: 0.85em; color: #666; margin-top: 10px; font-style: italic;">Ce document fournit une indication générale et ne constitue pas un avis juridique.</p>
        </div>
        <div id="pdf-results" style="color: #1a202c;"></div>
        <div class="pdf-footer" style="margin-top: 30px; padding-top: 15px; border-top: 2px solid #e2e8f0; text-align: center; color: #2563eb;">
            <p style="color: #2563eb; margin: 5px 0;"><strong style="color: #2563eb;">AgileVizion</strong> — Conseil GRC et Cybersécurité</p>
            <p style="color: #2563eb; margin: 5px 0;">emmanuel.genesteix@agilevizion.com | agilevizion.com</p>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script src="../js/i18n.js"></script>
    <script src="../js/loader.js"></script>
    <script src="../js/simulator.js?v=3.2"></script>
</body>
</html>
